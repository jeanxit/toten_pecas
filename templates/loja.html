<!DOCTYPE html>
  <html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Grupo AIZ | Loja de Pe√ßas para Caminh√µes</title>
    <style>
      :root {
        --azul-escuro: #1E3161;
        --azul-claro: #369ED8;
        --verde-claro: #4CAF50;
        --verde-escuro: #388E3C;
        --cinza-fundo: #f5f7fa;
      }

      body {
        margin: 0;
        font-family: 'Segoe UI', sans-serif;
        background-color: var(--cinza-fundo);
        color: var(--azul-escuro);
        font-size: 18px;
      }

      header {
        background: var(--azul-escuro);
        color: white;
        padding: 25px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        position: sticky;
        top: 0;
        z-index: 1000;
      }

      .logo {
        text-align: center;
        flex-grow: 1;
      }

      .logo img {
        height: 60px;
      }

      .carrinho {
        font-size: 32px;
        cursor: pointer;
        transition: color 0.3s ease;
        color: white;
        text-decoration: none;
      }

      .carrinho:hover {
        color: var(--azul-claro);
      }

      .menu-toggle {
        background: none;
        border: none;
        font-size: 30px;
        cursor: pointer;
        color: white;
      }

      /* Estilo para a sidebar */
  .sidebar {
    position: fixed;
    top: 0;
    left: -300px; /* Ajuste a largura para 300px */
    width: 300px; /* Largura aumentada da sidebar */
    height: 100%;
    background-color: #fff;
    padding: 20px 0;
    box-shadow: 2px 0 12px rgba(0, 0, 0, 0.1);
    border-radius: 0 20px 20px 0;
    transition: left 0.3s ease;
    z-index: 2000;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    padding-bottom: 0px;
  }

  /* Exibe a sidebar quando a classe "show" for aplicada */
  .sidebar.show {
    left: 0;
  }
  .bem-vindo {
  background-color: #F5F7FA; /* fundo claro */
  padding: 20px; /* espa√ßamento interno */
  border-radius: 10px; /* cantos arredondados */
  text-align: center; /* centraliza o texto */
  margin-bottom: 20px; /* espa√ßo abaixo */
}

.bem-vindo h2 {
  font-size: 24px;
  margin-bottom: 10px;
  color: #333;
}

.bem-vindo p {
  font-size: 16px;
  color: #666;
}


  /* Lista de itens na sidebar */
  .sidebar ul {
    list-style: none;
    padding: 0;
    margin: 0;
    margin-top: 20px;
  }

  .sidebar ul li {
    margin: 10px 0;
  }

  /* Ajuste para a largura do fundo azul das categorias */
  .sidebar ul li a {
    color: #fff; /* Cor da letra em branco */
    background-color: #1E3161; /* Cor de fundo azul escuro */
    padding: 10px 15px; /* Ajuste do padding para diminuir a largura */
    text-decoration: none;
    display: block;
    border-radius: 5px;
    transition: background-color 0.3s, color 0.3s;
    width: 240px; /* A largura ser√° determinada pelo conte√∫do */
    margin-left: 10px;

  }

  /* Opcional: Ajuste para quando o item estiver em hover */
  .sidebar ul li a:hover {
    background-color: #005b99; /* Cor mais clara quando passar o mouse */
    color: white;
  }

.botao {
    background-color: #4CAF50;
    color: #fff;
    padding: 8px 16px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 600;
    transition: background-color 0.2s ease;
  }

  .botao:hover {
    background-color: #0056b3;
  }
  /* Bot√£o de fechar a sidebar */
  .fechar-sidebar {
    background: none;
    border: none;
    font-size: 28px;
    color: #6c5ce7;
    position: absolute;
    top: 15px;
    right: 15px;
    cursor: pointer;
    margin-bottom: 10px;
  }

  .produtos-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
    gap: 20px;
    padding: 20px;
  }

  .produto {
    background: #fff;
    border-radius: 12px;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.08);
    padding: 15px;
    text-align: center;
    transition: transform 0.2s ease;
  }

  .produto:hover {
    transform: translateY(-5px);
  }

  .produto img {
    width: 100%;
    height: 180px;
    object-fit: contain;
    border-radius: 8px;
    margin-bottom: 10px;
  }

  .produto h3 {
  font-size: 1.1rem;
  color: #333;
  margin: 10px 0;
  height: 40px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}


  .preco-produto {
    font-size: 1.1rem;
    color: #28a745;
    font-weight: bold;
    margin-bottom: 10px;
  }

  .produto .botao {
  background-color: #1E3161;
  color: #fff;
  padding: 14px 28px; /* aumentei o preenchimento */
  font-size: 18px;     /* aumentei o tamanho da fonte */
  border: none;
  border-radius: 8px;
  cursor: pointer;
  font-weight: 600;
  transition: background-color 0.2s ease;
}

  .produto .botao:hover {
    background-color: #0056b3;
  }

  .categoria {
    display: none; /* Continua oculta, usada para filtragem */
  }

  /* Modal */
  .modal {
    display: none;
    position: fixed;
    z-index: 9999;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: auto;
    background-color: rgba(30, 49, 97, 0.85);
  }

  .modal-conteudo {
    background-color: #fff;
    margin: 5% auto;
    padding: 20px;
    border-radius: 12px;
    max-width: 600px;
    position: relative;
    text-align: center;
  }

  .modal-conteudo img {
    width: 100%;
    height: auto;
    margin-bottom: 15px;
    border-radius: 8px;
  }

#modalEspecificacoes {
  margin-top: 20px;
  width: 100%;
  border-collapse: collapse;
}

#modalEspecificacoes td {
  padding: 8px;
  border: 1px solid #ddd;
}

#modalEspecificacoes td:first-child {
  font-weight: bold;
}

#modalEspecificacoes td {
  text-align: left;
}


  .fechar {
    color: #aaa;
    position: absolute;
    top: 15px;
    right: 25px;
    font-size: 28px;
    cursor: pointer;
    background: none;
    border: none;
  }

  .fechar:hover {
    color: black;
  }

  #modalPreco {
    font-size: 24px;
    color: var(--verde-claro);
    font-weight: bold;
    margin-top: 20px;
  }

  /* Estilo para subcategorias */
  .subcategorias {
    display: none;
    list-style: none;
    padding-left: 20px;
  }

  .subcategorias li a {
    text-decoration: none;
    color: #333;
  }

  .subcategorias li a:hover {
    color: #007BFF;
  }

  /* Estilo da seta */
  .seta {
    font-size: 16px;
    margin-left: 10px;
    transition: transform 0.3s;
  }

  .seta-up {
    transform: rotate(-180deg);
  }

  /* Estilo para os itens principais */
  .item-principal {
    color: rgb(255, 255, 255); /* Azul escuro */
    background-color: #003366; /* Cor de fundo clara */
    padding: 10px;
    text-decoration: none;
    display: block;
    border-radius: 5px; /* Bordas arredondadas */
    margin: 5px 0;
    transition: background-color 0.3s, color 0.3s;
  }

  .item-principal:hover {
    background-color: #fff; /* Fundo branco ao passar o mouse */
    color: #003366; /* Texto azul escuro ao passar o mouse */
  }

  /* Estilo para a nova div categorias-container */
  .categorias-container {
      padding: 10px;
      background-color: transparent; /* Cor de fundo */
      border-radius: 8px;
      margin-bottom: 20px; /* Espa√ßamento inferior */
  }

  .categorias-container .subcategorias {
      list-style: none;
      padding-left: 0px;
      margin: 0;
  }

  .categorias-container .subcategorias li a {
      color: #333;
      background-color: #d3d3d3;
      padding: 10px 15px;
      text-decoration: none;
      display: block;
      border-radius: 5px;
      transition: background-color 0.3s, color 0.3s;
  }

  .categorias-container .subcategorias li a:hover {
      background-color: #b0b0b0;
      color: #fff;
  }

  .perfil {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 20px 0;
  }

  .foto-perfil {
    width: 80px;
    height: 80px;
    background-color: #ccc;
    border-radius: 50%;
    background-image: url('https://i.ibb.co/DDzyBSkm/do-utilizador.png'); /* Troque para foto real */
    background-size: cover;
    background-position: center;
    margin-bottom: 10px;
  }

  .nome-perfil {
    font-size: 18px;
    font-weight: bold;
    text-align: center;
    color: #333;
  }

  .botao-sair {
  background-color: #d9534f;
  color: white;
  border: none;
  padding: 12px;
  border-radius: 8px;
  font-weight: bold;
  cursor: pointer;
  width: calc(100% - 20px);
  transition: background 0.3s;
  position: absolute;
  bottom: 20px;
  left: 10px;
  right: 10px;
  margin-bottom: 10px;
}


  .botao-sair:hover {
    background-color: #c9302c;
  }


    </style>
  </head>
 <body>
  <header>
    <div style="margin: 0 15px;">
      <button class="menu-toggle">&#9776;</button>
    </div>

    <div class="logo">
      <a href="/">
        <img src="https://www.aizparts.com.br/tpl/img/logo.png" alt="Logo do Grupo AIZ" />
      </a>
    </div>

    <a href="{{ url_for('carrinho') }}" class="carrinho" title="Ir para o carrinho">
      <img src="https://i.ibb.co/wh510dXq/grocery-store.png" alt="Carrinho de compras" style="width: 40px; height: 40px;">
    </a>
  </header>

  <!-- Sidebar -->
  <nav class="sidebar">
    <button class="fechar-sidebar">&times;</button>

    <div class="perfil">
      <div class="foto-perfil"></div>
      <div class="nome-perfil"> {{ nome }}</div>
    </div>

    <ul>
      <li><a href="/filtro" class="item-principal">In√≠cio</a></li>
      <li>
        <a href="javascript:void(0);" class="categorias-toggle">
          Categorias <span class="seta">&#9660;</span>
        </a>
        <div class="categorias-container">
          <ul class="subcategorias">
            <li><a href="#" data-categoria="Todos" class="filtrar-categoria">Todos</a></li>
            <li><a href="#" data-categoria="Anf√≠bia" class="filtrar-categoria">Anf√≠bia</a></li>
            <li><a href="#" data-categoria="Bitrem" class="filtrar-categoria">Bitrem</a></li>
            <li><a href="#" data-categoria="Comboio" class="filtrar-categoria">Comboio</a></li>
            <li><a href="#" data-categoria="Escavadeira" class="filtrar-categoria">Escavadeira</a></li>
            <li><a href="#" data-categoria="Guindaste" class="filtrar-categoria">Guindaste</a></li>
            <!-- <li><a href="#" data-categoria="Pe√ßas AIZ" class="filtrar-categoria">Pe√ßas AIZ</a></li> -->
            <!-- <li><a href="#" data-categoria="Pe√ßas Diversas" class="filtrar-categoria">Pe√ßas Diversas</a></li> -->
            <li><a href="#" data-categoria="Pipa" class="filtrar-categoria">Pipa</a></li>
            <li><a href="#" data-categoria="Rodotrem" class="filtrar-categoria">Rodotrem</a></li>
            <li><a href="#" data-categoria="Outro" class="filtrar-categoria">Outro</a></li>
          </ul>
        </div>
      </li>
      <!-- <li><a href="/carrinho" class="item-principal">Carrinho</a></li>
      <li><a href="/contato" class="item-principal">Contato</a></li> -->
    </ul>

    <form action="/logout" method="POST">
    <button class="botao-sair">Sair da Conta</button>
    </form>
  </nav>

  <main class="container">
    <section class="bem-vindo">
      <h2>Ol√°, {{ nome }} üëã</h2>
      <p>Confira os itens dispon√≠veis e monte seu pedido:</p>
    </section>

    <section class="produtos-grid">
      {% if produtos %}
        {% for p in produtos %}
        <div class="produto">
          <!-- Categoria oculta para filtragem -->
          <div class="categoria" style="display: flex;">{{ p['ComprimentoCM'] | default('Outro') }}</div>
          
          <img src="{{ p['Imagem'] or 'https://www.aizparts.com.br/uploads/679a2e3e28c07.jpg' }}" alt="Imagem do Produto" />
          <h3> {{ p['Descricao'] if p['Descricao'] else 'Produto sem nome' }}</h3>
          <div class="preco-produto">
            <p>
              <strong>
                R$ {{ '{:,.2f}'.format(p['PrecoVenda'] if p['PrecoVenda'] != '-' else 0.00).replace(",", "X").replace(".", ",").replace("X", ".") }}
              </strong>
            </p>
          </div>

          <!-- Exibindo comprimento do produto no card -->
          <!-- <div class="comprimento-produto">
            <p style="color: #fff;"> {{ p['ComprimentoCM'] | default('-') }}</p>
          </div> -->

          <button class="botao" style="margin-top: 10px;"
            onclick="abrirModal(
              '{{ p['Descricao'] | escape }}', 
              '{{ '{:,.2f}'.format(p['PrecoVenda'] if p['PrecoVenda'] != '-' else 0.00).replace(",", "X").replace(".", ",").replace("X", ".") }}',
              '{{ p['Descricao'] | escape }}', 
              '{{ p['Imagem'] or 'https://www.aizparts.com.br/uploads/679a2e3e28c07.jpg' }}', 
              '{{ p['CodigoProduto'] }}',
              '{{ p['Fabricante'] | default('-') | escape }}',
              '{{ p['Categoria'] | default('-') | escape }}',
              '{{ p['ComprimentoCM'] | default('-') | escape }}',
              '{{ p['PesoCM'] | default('-') | escape }}',
              '{{ p['QuantidadeEstoque'] | default('-') | escape }}'
            )">
            Ver Detalhes
          </button>
        </div>
        {% endfor %}
      {% else %}
        <p>N√£o h√° produtos dispon√≠veis.</p>
      {% endif %}
    </section>
  </main>

 <div id="modalProduto" class="modal">
  <div class="modal-conteudo">
    <button class="fechar" type="button" onclick="fecharModal()">&times;</button>
    <img id="modalImagem" src="https://www.aizparts.com.br/uploads/679a2e3e28c07.jpg" alt="">
    <h3 id="modalTitulo"></h3>
    <p><strong id="modalPreco"></strong></p>

    <!-- T√≠tulo Especifica√ß√µes -->
    <h4 style="margin-top: 20px;">Especifica√ß√µes</h4>

    <!-- Tabela de Especifica√ß√µes -->
    <table id="modalEspecificacoes" style="width: 100%; margin-top: 10px; border-collapse: collapse;">
      <tr>
        <td><strong>Fabricante:</strong></td>
        <td id="modalFabricante"></td>
      </tr>
      <tr>
        <td><strong>Comprimento:</strong></td>
        <td id="modalComprimento"></td>
      </tr>
      <tr>
        <td><strong>Peso:</strong></td>
        <td id="modalPeso"></td>
      </tr>
      <tr>
        <td><strong>Estoque:</strong></td>
        <td id="modalEstoque"></td>
      </tr>
    </table>

    <form id="modalForm" method="POST" action="/adicionar">
      <input type="hidden" id="modalCodigoProduto" name="CodigoProduto" value="">
      <button type="submit" class="botao">Adicionar ao Carrinho</button>
    </form>
  </div>
</div>





  <script>
    document.querySelector('.categorias-toggle').addEventListener('click', function() {
      var subcategorias = document.querySelector('.subcategorias');
      var seta = document.querySelector('.seta');
      subcategorias.style.display = subcategorias.style.display === 'block' ? 'none' : 'block';
      seta.classList.toggle('seta-up');
    });

    document.addEventListener("DOMContentLoaded", () => {
      window.abrirModal = function(titulo, preco, descricao, imagem, codigoProduto, fabricante, categoria, comprimento, peso, estoque) {
        const modal = document.getElementById('modalProduto');
        document.getElementById('modalTitulo').textContent = titulo;
        document.getElementById('modalPreco').textContent = `R$ ${preco}`;
        document.getElementById('modalDescricao').textContent = descricao;
        document.getElementById('modalImagem').src = imagem || 'https://www.aizparts.com.br/uploads/679a2e3e28c07.jpg';
        document.getElementById('modalCodigoProduto').value = codigoProduto;

        // Novos campos
        document.getElementById('modalFabricante').textContent = fabricante || '-';
        document.getElementById('modalComprimento').textContent = comprimento || '-';
        document.getElementById('modalPeso').textContent = peso ? `${peso} kg` : '-';
        document.getElementById('modalEstoque').textContent = estoque || '-';

        modal.style.display = 'block';
      };

      window.fecharModal = function() {
        const modal = document.getElementById('modalProduto');
        if (modal) modal.style.display = 'none';
      };

      window.onclick = function(event) {
        const modal = document.getElementById('modalProduto');
        if (event.target === modal) {
          fecharModal();
        }
      };

      // Sidebar JS
      const menuToggle = document.querySelector('.menu-toggle');
      const sidebar = document.querySelector('.sidebar');
      const fecharSidebar = document.querySelector('.fechar-sidebar');

      menuToggle.addEventListener('click', () => {
        sidebar.classList.add('show');
      });

      fecharSidebar.addEventListener('click', () => {
        sidebar.classList.remove('show');
      });

      // Fun√ß√£o para filtrar os produtos por categoria
      function filtrarProdutosPorCategoria(categoriaSelecionada) {
        const produtos = document.querySelectorAll('.produto');

        produtos.forEach(produto => {
          const categoriaProduto = produto.querySelector('.categoria').textContent.trim();

          // Mostrar ou esconder o produto baseado na categoria selecionada
          if (categoriaSelecionada === 'Todos' || categoriaProduto === categoriaSelecionada) {
            produto.style.display = 'block'; // Exibir o produto
          } else {
            produto.style.display = 'none'; // Ocultar o produto
          }
        });
      }

      // Adicionando evento para as categorias
      const categoriasLinks = document.querySelectorAll('.filtrar-categoria');
      categoriasLinks.forEach(link => {
        link.addEventListener('click', function(event) {
          event.preventDefault();
          const categoriaSelecionada = event.target.getAttribute('data-categoria');
          filtrarProdutosPorCategoria(categoriaSelecionada);
        });
      });
    });
  </script>
</body>
  </html>